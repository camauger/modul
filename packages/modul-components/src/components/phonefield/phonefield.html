<div class="m-phonefield"
     :class="{ 'm--is-disabled': disabled,
                'm--is-waiting': waiting,
                'm--is-country-focus': internalFocus && !hasError }">
    <div class="m-phonefield__wrapper">
        <m-select class="m-phonefield__country"
                  :value="countryModel"
                  :options="isoCountries"
                  :disabled="disabled"
                  :readonly="isReadonly"
                  :error="hasPhonefieldError"
                  :valid="isPhonefieldValid"
                  :label-up="true"
                  :label="i18nCountryLabel"
                  width="auto"
                  :virtual-scroll="true"
                  @input="onContryChanged($event)"
                  @open="onContrySelectOpen"
                  @focus="onSelectFocus"
                  @blur="onSelectBlur">
            <template v-slot:default="scope">
                <div class="m-phonefield__flag-wrapper"
                     @focus="scope.focus"
                     @blur="scope.blur"
                     @keydown.up.prevent="scope.keyUp"
                     @keydown.down.prevent="scope.keyDown"
                     @keydown.enter.prevent="scope.keyEnter"
                     @keydown.esc="scope.keyEsc"
                     @keydown.tab="scope.keyTab"
                     @keydown.space="scope.keySpace"
                     :tabindex="disabled ? '-1' : '0'"
                     ref="flag">
                    <svg class="m-phonefield__flag"
                         width="27px"
                         height="20px">
                        <use :xlink:href="spriteId(countryModel)"
                             aria-hidden="true"></use>
                    </svg>
                </div>
            </template>
            <template slot="items"
                      slot-scope="{item, index}">
                <div class="m-phonefield__item-wrapper">
                    <div class="m-phonefield__item-flag-wrapper">
                        <svg width="27px"
                             height="20px">
                            <use :xlink:href="spriteId(item)"
                                 aria-hidden="true"></use>
                        </svg>
                    </div>
                    <span class="m-phonefield__item-name">{{ countries[index].name }}</span>
                    <span class="m-phonefield__item-dialCode">+{{ countries[index].dialCode }}</span>
                </div>
            </template>
        </m-select>
        <m-input-style class="m-phonefield__number"
                       :disabled="disabled"
                       :waiting="waiting"
                       :error="hasPhonefieldError"
                       :valid="isPhonefieldValid"
                       :label="propLabel"
                       :label-for="id"
                       :focus="isFocus"
                       :label-up="true"
                       :empty="isEmpty"
                       :readonly="isReadonly"
                       :required-marker="requiredMarker"
                       :tag-style="tagStyle">
            <m-input-mask ref="inputMask"
                          :value="internalValue"
                          :id="id"
                          :disabled="disabled"
                          :placeholder="placeholder"
                          :readonly="isReadonly"
                          :options="inputMaskOptions"
                          @input="inputChanged($event)"
                          @focus="onFocus"
                          @blur="onBlur"
                          @keyup="onKeyup"
                          @change="onChange"></m-input-mask>
        </m-input-style>
        <div></div>
        <p class="m-phonefield__example"
           x-ms-format-detection="none">{{ i18nExample }}{{ example }}</p>

    </div>
    <div class="m-phonefield__validation">
        <m-validation-message class="m-phonefield__validation-message"
                              :disabled="disabled"
                              :waiting="waiting"
                              :error="hasPhonefieldError"
                              :error-message="errorMessage"
                              :valid="isPhonefieldValid"
                              :valid-message="validMessage"
                              :helper-message="helperMessage"></m-validation-message>
    </div>

</div>
